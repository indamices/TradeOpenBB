# 开发计划文档

## 开发目标

完成以下任务：
- ✅ 任务1.1：回测记录存储系统
- ✅ 任务1.2：Alpha Vantage集成
- ✅ 任务2.1：回测结果增强
- ✅ 任务2.2：参数优化功能
- ✅ 任务2.3：AI策略分析建议
- ✅ 任务3.1：富途OpenAPI集成（可选）
- ✅ 任务3.2：回测对比可视化增强

## 开发阶段

### 阶段1：核心功能（优先级最高）

#### 任务1.1：回测记录存储系统
**目标**：实现回测记录的存储、查询、更新、删除和导出功能

**子任务**：
1. ✅ 创建BacktestRecord数据库模型
2. ✅ 创建BacktestRecord相关Schema
3. ✅ 修改回测API端点，添加save_record参数
4. ✅ 实现回测记录CRUD API端点
5. ✅ 实现CSV导出功能
6. ✅ 实现Excel导出功能
7. ✅ 更新前端TypeScript类型定义
8. ✅ 更新前端服务添加回测记录API

**预计工作量**：3-5天

#### 任务1.2：Alpha Vantage集成
**目标**：集成Alpha Vantage作为备用数据源

**子任务**：
1. ✅ 创建AlphaVantageService服务类
2. ✅ 将Alpha Vantage集成到data_service.py
3. ✅ 更新可用数据源列表
4. ✅ 更新requirements.txt

**预计工作量**：2-3天

### 阶段2：增强功能

#### 任务2.1：回测结果增强
**目标**：增加更多回测分析指标

**子任务**：
1. ✅ 实现月度/季度收益分解
2. ✅ 实现换手率和持仓周期统计
3. ✅ 增强风险指标计算

**预计工作量**：3-5天

#### 任务2.2：参数优化功能
**目标**：实现策略参数自动优化

**子任务**：
1. ✅ 创建参数优化服务
2. ✅ 实现网格搜索算法
3. ✅ 创建参数优化API端点
4. ✅ 创建前端参数优化组件

**预计工作量**：5-7天

#### 任务2.3：AI策略分析建议
**目标**：AI分析回测结果并给出优化建议

**子任务**：
1. ✅ 创建AI策略分析服务
2. ✅ 实现AI分析API端点
3. ✅ 创建前端AI分析展示组件

**预计工作量**：3-5天

### 阶段3：高级功能

#### 任务3.1：富途OpenAPI集成（可选）
**目标**：集成富途API获取资金流向等高级数据

**子任务**：
1. ✅ 创建FutuService服务类
2. ✅ 集成富途到data_service.py
3. ✅ 添加富途到可用数据源列表

**预计工作量**：5-7天
**注意**：需要安装OpenD并登录富途账户

#### 任务3.2：回测对比可视化增强
**目标**：增强多策略对比的可视化效果

**子任务**：
1. ✅ 增强BacktestComparison组件，添加净值曲线同图展示
2. ✅ 实现交互式图表功能

**预计工作量**：3-5天

## 开发顺序

1. 任务1.1（回测记录存储）- 核心功能
2. 任务1.2（Alpha Vantage）- 数据源增强
3. 任务2.1（回测结果增强）- 功能完善
4. 任务2.2（参数优化）- 重要功能
5. 任务2.3（AI分析）- 智能功能
6. 任务3.1（富途集成）- 可选功能
7. 任务3.2（对比增强）- 体验优化

## 技术依赖

### 新增Python依赖
- openpyxl>=3.1.0（Excel导出）
- alpha-vantage>=2.3.1（可选，或直接使用requests）
- futu>=6.0.0（可选，富途集成）

### 环境变量
- ALPHA_VANTAGE_API_KEY（已获得：23QHIAUTJM0L72OE）

## 数据库变更

### 新增表
- backtest_records（回测记录表）

### 迁移说明
需要执行数据库迁移或直接运行init_db()创建新表
