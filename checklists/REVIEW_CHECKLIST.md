# 代码审查检查清单
# Code Review Checklist - 每次审查前必须完成

## 📋 审查前准备

### 必须执行的扫描
- [ ] 运行 `./scripts/quick-scan.sh`
- [ ] 查看 `scan-results.txt`
- [ ] 记录发现的问题数量和严重程度

### 必须收集的信息
- [ ] 审查范围（哪些文件/模块）
- [ ] 审查目标（性能/安全/功能/重构）
- [ ] 当前的基线情况（有多少已知问题）

---

## 🔍 详细检查项

### Python 后端代码

#### 安全性
- [ ] SQL 注入风险检查
- [ ] 敏感信息泄露（API密钥、密码）
- [ ] 输入验证缺失
- [ ] 权限检查缺失

#### 错误处理
- [ ] 空的 except 块
- [ ] 异常被静默吞掉
- [ ] 异常信息泄露内部实现

#### 代码质量
- [ ] 硬编码路径/配置
- [ ] 重复代码（DRY 原则）
- [ ] 过长函数（>50行）
- [ ] 命名不清晰
- [ ] 类型注解缺失

#### 性能
- [ ] N+1 查询问题
- [ ] 未优化的循环
- [ ] 不必要的数据库查询
- [ ] 缺少缓存

#### 日志和调试
- [ ] 调试代码遗留（print, debug.log）
- [ ] 敏感信息记录到日志
- [ ] 日志级别不当

---

### TypeScript/React 前端代码

#### 类型安全
- [ ] `as any` 使用
- [ ] `any` 类型定义
- [ ] 类型断言过度使用
- [ ] 缺少类型定义

#### 空值安全
- [ ] 对象属性访问缺少 `?.`
- [ ] 数组方法缺少空值检查
- [ ] 可选参数处理不当
- [ ] `.toFixed()` 等方法缺少空值检查

#### React 最佳实践
- [ ] useEffect 依赖数组缺失或不完整
- [ ] 缺少必要的 React.memo
- [ ] 缺少 useMemo/useCallback
- [ ] 列表 key 使用 index
- [ ] 内联函数/对象导致重渲染

#### 错误处理
- [ ] 空 catch 块
- [ ] 错误被忽略
- [ ] 用户看不到错误信息
- [ ] 缺少 ErrorBoundary

#### 代码质量
- [ ] console.log/debug 遗留
- [ ] 重复代码
- [ ] 过长组件（>300行）
- [ ] 命名不清晰
- [ ] 魔法数字/字符串

#### 性能
- [ ] 不必要的重渲染
- [ ] 缺少虚拟滚动（长列表）
- [ ] 图片未优化
- [ ] 大组件未拆分

---

### 跨领域检查

#### 代码重复
- [ ] 重复的导入语句
- [ ] 重复的配置定义
- [ ] 重复的逻辑代码

#### 配置管理
- [ ] 硬编码配置值
- [ ] 环境变量未使用
- [ ] 配置散落在各处

#### 文档
- [ ] 复杂逻辑缺少注释
- [ ] 函数缺少文档字符串
- [ ] API 文档过时

#### 测试
- [ ] 缺少单元测试
- [ ] 测试覆盖不足
- [ ] 测试质量差

---

## 📊 问题分级标准

### 🔴 P0 - 严重（立即修复）

**判定标准：**
- 导致应用崩溃
- 安全漏洞
- 数据丢失风险
- 生产环境故障

**示例：**
- 硬编码路径导致生产环境失败
- SQL 注入漏洞
- 空指针异常导致崩溃
- 数据库连接未关闭

---

### 🟡 P1 - 中等（尽快修复）

**判定标准：**
- 影响用户体验
- 影响代码维护性
- 性能问题
- 可能导致问题的边缘情况

**示例：**
- 类型安全问题（as any）
- 错误处理不完整
- N+1 查询问题
- 缺少空值检查

---

### 🟢 P2 - 轻微（有时间修复）

**判定标准：**
- 代码质量问题
- 不影响功能
- 不影响用户体验
- 改进空间

**示例：**
- 命名不清晰
- 缺少注释
- 代码风格不一致
- 魔法数字

---

## ✅ 审查完成标准

### 最小要求
- [ ] 运行了快速扫描脚本
- [ ] 验证了所有发现的问题
- [ ] 提供了具体的修复代码
- [ ] 重新扫描验证修复

### 完整要求
- [ ] 运行快速和详细扫描
- [ ] 检查了所有必检项
- [ ] 按优先级分类问题
- [ ] 提供修复和测试方案
- [ ] 更新相关文档
- [ ] 运行回归测试

---

## 📝 审查报告模板

```markdown
## 代码审查报告 - [项目/模块名称]

### 审查信息
- 审查日期: YYYY-MM-DD
- 审查人: [姓名]
- 审查范围: [文件/模块]
- 扫描结果: scan-results.txt

### 问题汇总
- 🔴 P0 严重: X 个
- 🟡 P1 中等: Y 个
- 🟢 P2 轻微: Z 个
- 总计: X+Y+Z 个

### 详细问题列表

#### 🔴 P0-严重问题

**问题 #1: [标题]**
- 文件: `文件路径:行号`
- 严重性: P0
- 扫描命令: `命令`
- 问题代码:
  ```代码
  ```
- 影响: [具体影响]
- 修复方案:
  ```代码
  ```
- 验证: [验证方法]

### 修复统计
- 已修复: X
- 待修复: Y
- 需讨论: Z

### 回归测试
- [ ] 快速扫描通过
- [ ] 相关测试通过
- [ ] 功能测试通过

### 下一步行动
1. [ ] [具体行动项]
2. [ ] [具体行动项]
3. [ ] [具体行动项]
```

---

## 🔄 持续改进

### 每次审查后更新
- [ ] 更新扫描脚本（添加新模式）
- [ ] 更新检查清单（添加新项）
- [ ] 记录发现的常见问题
- [ ] 分享审查经验

### 定期审查
- [ ] 每周审查一次新代码
- [ ] 每月全面审查一次
- [ ] 每季度评估审查标准

---

**检查清单版本**: 1.0.0
**最后更新**: 2026-01-19
**状态**: 已批准，严格遵循
